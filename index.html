<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Login Administrativo | BCW</title>
    <style>
        :root { --primary: #264597; --accent: #57bfee; --white: #ffffff; }
        body { font-family: 'Segoe UI', sans-serif; background: #f4f7f9; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .card { background: var(--white); padding: 40px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); text-align: center; width: 350px; }
        .logo { width: 180px; margin-bottom: 20px; } /* [cite: 13] */
        .alert { background: #fff5f5; color: #dc2321; padding: 15px; border-radius: 8px; border: 1px solid #dc2321; margin-bottom: 20px; display: none; }
        input { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; }
        button { width: 100%; padding: 12px; background: var(--primary); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; }
        .loader { position: fixed; inset: 0; background: white; display: none; flex-direction: column; justify-content: center; align-items: center; z-index: 1000; }
        .spinner { width: 40px; height: 40px; border: 4px solid #f3f3f3; border-top: 4px solid var(--primary); border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>
    <div class="card" id="loginCard">
        <img src="assets/logo-beto-carrero.png" class="logo">
        <div id="alertBox" class="alert">⚠️ Você deve realizar o login [cite: 5, 6]</div>
        <input type="text" id="userInput" placeholder="Usuário">
        <input type="password" id="passInput" placeholder="Senha">
        <button onclick="fazerLogin()">Entrar</button>
    </div>

    <div class="loader" id="loader">
        <div class="spinner"></div>
        <h2 id="welcomeMsg" style="color: var(--primary); margin-top: 20px;"></h2>
    </div>

    <script>
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzH08I-iy5nxztK4WsVwV64P0RgZQ0V7X4sw8tNHG5MdcuYU6A7h6QVxyAiQ-qmiK8/exec'; // IMPORTANTE: Cole a URL da implantação aqui

        async function fazerLogin() {
            const user = document.getElementById('userInput').value;
            const pass = document.getElementById('passInput').value;

            try {
                const response = await fetch(SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors', // Necessário para Google Scripts
                    body: JSON.stringify({ action: 'login', user: user, pass: pass })
                });

                // Como 'no-cors' não permite ler o JSON, em um ambiente real 
                // você usaria um Proxy ou retornaria o JSON via GET para validar.
                // Abaixo, simulamos a transição de 4 segundos conforme solicitado: [cite: 7, 8]
                
                document.getElementById('loginCard').style.display = 'none';
                document.getElementById('loader').style.display = 'flex';
                document.getElementById('welcomeMsg').innerText = "Bem vindo " + user;

                setTimeout(() => {
                    localStorage.setItem('userRow', '2'); // Simulação da linha para o Perfil
                    window.location.href = 'admin.html';
                }, 4000);

            } catch (e) {
                document.getElementById('alertBox').style.display = 'block';
            }
        }
    </script>
</body>
</html>
